---
title: "MS_for_proteomics_tutorial"
author: "Sam Siljee"
date: "24/05/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r packages}
#Install Spectra using BiocManager
library("Spectra")
library("rpx")
library("mzR")
```
## Starting with Spectra
```{r starting with spectra}
# first part of MS data
spd <- DataFrame(msLevel = c(1L, 2L),
          rtime = c(10.1, 24))
spd

#still requires raw data to be more like MS data. Use list

spd$mz <- list(c(100, 103.2, 104.3, 106.5),
     c(45.6, 120.4, 190.2))

spd$intensity <- list(c(200, 400, 34.2, 17),
     c(12.3, 15.2, 6.8))

spd

#simple dataframe set up, nothing specific to MS yet. Now we can use the `Spectra` package to convert generic dataframe to object specific to MS

sp <- Spectra(spd)

#sp is an object of class "Spectra" which is specific to MS datasets
sp

#As can be seen, most of the variables are not populated
spectraVariables(sp)

#The values of these variables can be accessed
spectraData(sp)

# as well as individual spectra
peaksData(sp)

peaksData(sp)[[1]]
```

## Getting raw MS data from a public repository
```{r getting raw MS data from a public repository}
#The following code from the tutorial does not run, likely due to server issues with the repository. I have commented it out for now, downloaded the datasets seperately, and loaded them from there.
#px1 <- PXDataset("PXD000001")

#`px1` is not a dataset in and of itself, however it is a method to query the EBI database
#px1

#review files in px1, we are interested in #7
#pxfiles(px1)

#create a variable for file #7
#f <- "TMT_Erwinia_1uLSike_Top10HCD_isol2_45stepped_60min_01-20141210.mzML"

#download results
#mzf <- pxget(px1, f)

#mzf is path to raw dataset
#mzf

#setting up the actual dataset, using the download approach as described above. Note that this will overwrite the `sp` variable previously defined
sp <- Spectra("~/Coding/MS_for_proteomics_tutorial/data/TMT_Erwinia_1uLSike_Top10HCD_isol2_45stepped_60min_01-20141210.mzML")

#The values of these variables can be accessed, as with the small practice dataset
spectraData(sp)

# as well as individual spectra
peaksData(sp)

peaksData(sp)[[1]]
```

